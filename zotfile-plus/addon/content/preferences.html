<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ZotFile+ Preferences</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            font-size: 13px;
            margin: 0;
            padding: 20px;
            background: white;
        }

        .section {
            margin-bottom: 25px;
        }

        h2 {
            font-size: 14px;
            font-weight: 600;
            margin: 0 0 15px 0;
            padding-bottom: 8px;
            border-bottom: 1px solid #ddd;
            color: #333;
        }

        .pref-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            gap: 10px;
        }

        label {
            flex: 0 0 200px;
            font-size: 12px;
            color: #555;
        }

        input[type="text"],
        input[type="number"] {
            flex: 1;
            padding: 4px 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        input[type="text"]:focus,
        input[type="number"]:focus {
            outline: none;
            border-color: #0066cc;
        }

        input[type="checkbox"] {
            margin: 0;
        }

        .help-text {
            font-size: 11px;
            color: #777;
            margin-top: 4px;
            margin-left: 210px;
        }

        .pattern-examples {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 4px;
            margin-top: 8px;
            font-size: 11px;
            font-family: 'Courier New', monospace;
        }

        .pattern-examples div {
            margin: 4px 0;
        }

        .buttons {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #ddd;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        button {
            padding: 6px 16px;
            border: 1px solid #ccc;
            border-radius: 3px;
            background: white;
            cursor: pointer;
            font-size: 12px;
        }

        button:hover {
            background: #f0f0f0;
        }

        button.primary {
            background: #0066cc;
            color: white;
            border-color: #0066cc;
        }

        button.primary:hover {
            background: #0052a3;
        }

        .wildcard-help {
            background: #fff9e6;
            padding: 12px;
            border-radius: 4px;
            margin-top: 10px;
            font-size: 11px;
        }

        .wildcard-help strong {
            display: inline-block;
            width: 40px;
            font-family: 'Courier New', monospace;
        }

        textarea {
            width: 100%;
            height: 120px;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 11px;
            resize: vertical;
        }

        textarea:focus {
            outline: none;
            border-color: #0066cc;
        }
    </style>
</head>
<body>
    <div class="section">
        <h2>Rename Pattern</h2>

        <div class="pref-row">
            <label for="renamePattern">Default Pattern:</label>
            <input type="text" id="renamePattern" />
        </div>

        <div class="pref-row">
            <label for="renameFormat_patent">Patent Pattern:</label>
            <input type="text" id="renameFormat_patent" />
        </div>

        <div class="wildcard-help">
            <strong>%a</strong> author (last names)<br>
            <strong>%y</strong> year<br>
            <strong>%t</strong> title (formatted)<br>
            <strong>%j</strong> journal/publication<br>
            <strong>%v</strong> volume<br>
            <strong>%e</strong> issue<br>
            <strong>%p</strong> publisher<br>
            <strong>%c</strong> collection path
        </div>

        <div class="pattern-examples">
            Examples:<br>
            <div>{%a_}{%y_}{%t} → Smith_2023_Machine_Learning.pdf</div>
            <div>{%a_}{%y}_{%j} → Smith_2023_Nature.pdf</div>
            <div>{%y}/{%a}_{%t} → 2023/Smith_Machine_Learning.pdf</div>
        </div>
    </div>

    <div class="section">
        <h2>Title Formatting</h2>

        <div class="pref-row">
            <label for="maxTitleLength">Maximum Title Length:</label>
            <input type="number" id="maxTitleLength" min="10" max="500" />
        </div>

        <div class="pref-row">
            <label for="truncateTitle">Truncate After Punctuation:</label>
            <input type="checkbox" id="truncateTitle" />
        </div>
        <div class="help-text">Truncate title after : . ? !</div>

        <div class="pref-row">
            <label for="smartTruncate">Smart Truncation:</label>
            <input type="checkbox" id="smartTruncate" />
        </div>
        <div class="help-text">Break at word boundaries, not mid-word</div>
    </div>

    <div class="section">
        <h2>Author Formatting</h2>

        <div class="pref-row">
            <label for="maxAuthors">Maximum Authors:</label>
            <input type="number" id="maxAuthors" min="1" max="20" />
        </div>

        <div class="pref-row">
            <label for="truncateAuthors">Truncate Authors:</label>
            <input type="checkbox" id="truncateAuthors" />
        </div>

        <div class="pref-row">
            <label for="addEtAl">Add "et al":</label>
            <input type="checkbox" id="addEtAl" />
        </div>

        <div class="pref-row">
            <label for="etAlString">"et al" String:</label>
            <input type="text" id="etAlString" />
        </div>

        <div class="pref-row">
            <label for="authorsDelimiter">Author Delimiter:</label>
            <input type="text" id="authorsDelimiter" maxlength="5" />
        </div>
        <div class="help-text">Character(s) to separate multiple authors (e.g., "_" or "-")</div>
    </div>

    <div class="section">
        <h2>File Types and Filters</h2>

        <div class="pref-row">
            <label for="useFileTypes">Use File Type Filtering:</label>
            <input type="checkbox" id="useFileTypes" />
        </div>

        <div class="pref-row">
            <label for="filetypes">File Types (semicolon-separated):</label>
            <input type="text" id="filetypes" />
        </div>
        <div class="help-text">List of file extensions to process (e.g., pdf;epub;mobi)</div>

        <div class="pref-row">
            <label for="allFiles">Include All Files:</label>
            <input type="checkbox" id="allFiles" />
        </div>
        <div class="help-text">Include all files regardless of type</div>
    </div>

    <div class="section">
        <h2>Text Processing</h2>

        <div class="pref-row">
            <label for="removeDiacritics">Remove Diacritics:</label>
            <input type="checkbox" id="removeDiacritics" />
        </div>
        <div class="help-text">Convert ä→a, é→e, ñ→n, etc.</div>

        <div class="pref-row">
            <label for="removePeriods">Remove Periods:</label>
            <input type="checkbox" id="removePeriods" />
        </div>

        <div class="pref-row">
            <label for="replaceBlanks">Replace Blanks with "_":</label>
            <input type="checkbox" id="replaceBlanks" />
        </div>

        <div class="pref-row">
            <label for="toLowerCase">Convert to Lowercase:</label>
            <input type="checkbox" id="toLowerCase" />
        </div>

        <div class="pref-row">
            <label for="useZoteroToRename">Use Zotero to Rename:</label>
            <input type="checkbox" id="useZoteroToRename" />
        </div>
        <div class="help-text">Use Zotero's built-in renaming instead of ZotFile+ engine</div>
    </div>

    <div class="section">
        <h2>Batch and Confirmation Settings</h2>

        <div class="pref-row">
            <label for="confirmation">Show Confirmation Dialog:</label>
            <input type="checkbox" id="confirmation" />
        </div>

        <div class="pref-row">
            <label for="confirmation_batch_ask">Ask for Batch Confirmation:</label>
            <input type="checkbox" id="confirmation_batch_ask" />
        </div>

        <div class="pref-row">
            <label for="confirmation_batch">Batch Size Threshold:</label>
            <input type="number" id="confirmation_batch" min="1" max="100" />
        </div>
        <div class="help-text">Number of files that triggers batch confirmation dialog</div>

        <div class="pref-row">
            <label for="automatic_renaming">Automatic Renaming:</label>
            <select id="automatic_renaming">
                <option value="1">No</option>
                <option value="2">Ask</option>
                <option value="3">Ask for multiple</option>
                <option value="4">Always</option>
            </select>
        </div>
        <div class="help-text">Control when files are automatically renamed</div>

        <div class="pref-row">
            <label for="disable_renaming">Disable Renaming:</label>
            <input type="checkbox" id="disable_renaming" />
        </div>
        <div class="help-text">Disable all renaming functionality</div>
    </div>

    <div class="section">
        <h2>Custom Wildcards (Advanced)</h2>

        <div class="pref-row" style="flex-direction: column; align-items: stretch;">
            <label for="customWildcards">Custom Wildcards (JSON):</label>
            <textarea id="customWildcards" placeholder='{"k": "DOI", "u": "url"}'></textarea>
        </div>
        <div class="help-text">
            Define custom wildcards as JSON. Example: {"k": "DOI"} creates %k wildcard for DOI field.
        </div>
    </div>

    <div class="section">
        <h2>Advanced Settings</h2>

        <div class="pref-row">
            <label for="userInput">Allow User Input:</label>
            <input type="checkbox" id="userInput" />
        </div>

        <div class="pref-row">
            <label for="userInput_Default">Default User Input:</label>
            <input type="text" id="userInput_Default" />
        </div>

        <div class="pref-row">
            <label for="maxTitleLengthSmart">Smart Truncation with Max:</label>
            <input type="checkbox" id="maxTitleLengthSmart" />
        </div>
        <div class="help-text">Apply smart truncation when using max title length</div>

        <div class="pref-row">
            <label for="maxAuthorsTruncate">Max Authors When Truncated:</label>
            <input type="number" id="maxAuthorsTruncate" min="1" max="20" />
        </div>

        <div class="pref-row">
            <label for="truncate_authors_max">Max Authors Before Truncation:</label>
            <input type="number" id="truncate_authors_max" min="1" max="20" />
        </div>

        <div class="pref-row">
            <label for="zotero7transition">Zotero 7 Transition:</label>
            <input type="checkbox" id="zotero7transition" />
        </div>

        <div class="pref-row">
            <label for="zotfile3update">ZotFile 3 Update:</label>
            <input type="checkbox" id="zotfile3update" />
        </div>

        <div class="pref-row">
            <label for="info_window_duration">Info Window Duration (ms):</label>
            <input type="number" id="info_window_duration" min="1000" max="30000" />
        </div>

        <div class="pref-row">
            <label for="info_window_duration_clickable">Info Window Clickable Duration (ms):</label>
            <input type="number" id="info_window_duration_clickable" min="1000" max="30000" />
        </div>
    </div>

    <div class="buttons">
        <button id="resetButton">Reset to Defaults</button>
        <button id="cancelButton">Cancel</button>
        <button id="saveButton" class="primary">Save</button>
    </div>

    <script src="preferences.js"></script>
</body>
</html>
